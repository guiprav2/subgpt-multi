<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <script>
      window.rootPrefix = /^\/(files|preview)\//.test(location.pathname)
        ? location.pathname.split('/').slice(0, 4).join('/')
        : '/';
    </script>
    <script type="module" src="../webfoundry/ifdesigner.js"></script>
    <script src="../webfoundry/head.js"></script>
  </head>
  <body
    class="flex flex-col [&amp;&gt;div:first-child]:flex-1 min-h-screen"
    style="display: none"
  >
    <div
      class="min-h-screen flex flex-col sm:flex-row w-screen"
      wf-onattach="post('main.init')"
    >
      <style>
        em {
          font-style: normal;
          font-weight: bold;
        }
      </style>
      <div
        class="flex-col gap-3 p-8 z-10 shadow-xl flex w-screen bg-neutral-100 xl:h-screen shrink-0 md:w-92 md:overflow-auto"
      >
        <div class="flex items-center gap-2 pl-3">
          <div
            class="nf nf-md-chat_processing_outline text-lg"
            wf-if="state.main.tmp.panel"
            wf-class="{{replaces nf-md-chat_processing_outline: { threads: 'nf-md-chat_processing_outline', rooms: 'nf-fa-users', settings: 'nf-md-cog' }[state.main.tmp.panel]}}"
          ></div>
          <div class="truncate" wf-if="state.main.tmp.panel">
            {{state.main.tmp.panel[0].toUpperCase() + state.main.tmp.panel.slice(1)}}
          </div>
          <div class="flex-1"></div>
          <div
            class="flex items-center gap-0.5 text-gray-400"
            wf-if="state.main.options.oaiKey || state.main.options.xaiKey"
          >
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-fa-clone"
              wf-onclick="post('main.cloneThread')"
              wf-if="state.main.thread?.logs?.length"
              value=""
            ></button>

            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-md-filter_outline"
              wf-if="state.main.displayedThreads.length &amp;&amp; (state.main.options.filter.length || state.main.tags.length)"
              value=""
              wf-onclick="post('main.toggleShowFilter', event)"
              wf-class="{{state.main.tmp.showFilter &amp;&amp; 'bg-gray-200 text-gray-800'}} {{state.main.options.filter.length &amp;&amp; 'text-blue-600 hover:text-blue-600'}}"
            ></button>
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-md-archive_search"
              wf-onclick="post('main.toggleArchives', event)"
              wf-class="{{state.main.tmp.panel === 'archives' &amp;&amp; 'bg-gray-200 text-gray-800'}}"
              value=""
              wf-if="state.main.tmp.panel === 'archives' || state.main.threads.some(x =&gt; x.archived)"
            ></button
            ><button
              class="p-1.5 outline-none rounded-full hover:text-gray-800 flex gap-1 items-center"
              wf-onclick="post('main.toggleRooms')"
              wf-class="{{replaces hover:text-gray-800: state.main.tmp.panel !== 'rooms' ? (!state.main.options.rooms?.some?.(x =&gt; state.main.tmp.tryrooms?.[JSON.stringify([x.id, x.name])]) ? 'hover:text-gray-800' : 'text-green-600 hover:text-green-700') : (!state.main.options.rooms?.some?.(x =&gt; state.main.tmp.tryrooms?.[JSON.stringify([x.id, x.name])]) ? 'bg-gray-200 text-gray-800' : 'bg-green-200 text-green-600 hover:text-green-700')}}"
              value=""
            >
              <div
                class="truncate max-w-6 text-xs"
                wf-if="state.main.options.rooms.filter(x =&gt; state.main.tmp.tryrooms?.[JSON.stringify([x.id, x.name])]).length"
              >
                {{state.main.options.rooms.filter(x =&gt; state.main.tmp.tryrooms?.[JSON.stringify([x.id, x.name])]).length}}
              </div>
              <div class="nf nf-fa-users"></div>
            </button>
            <button
              class="nf nf-md-cog p-1.5 outline-none rounded-full hover:text-gray-800"
              wf-onclick="post('main.toggleSettings')"
              wf-class="{{state.main.tmp.panel === 'settings' &amp;&amp; 'bg-gray-200 text-gray-800'}}"
              value=""
            ></button>
          </div>
        </div>

        <!-- Typeahead input -->
        <!-- Display currently selected tags -->
        <div
          class="flex items-center gap-1.5 flex-wrap"
          wf-if="state.main.tmp.showFilter"
        >
          <div
            class="text-sm px-2 py-0.5 rounded-full shrink-0 flex items-center gap-2 bg-blue-200 text-blue-600"
            wf-map="x of state.main.options.filter.slice().sort()"
          >
            <div class="relative -top-[1px]">{{x}}</div>
            <button
              class="relative -top-[1px] outline-none"
              wf-onclick="post('main.rmFilter', x)"
              value=""
            >
              √ó
            </button>
          </div>
          <button
            class="nf nf-fa-plus text-gray-400 outline-none text-sm px-1 py-0.5"
            wf-onclick="post('main.toggleFilterInput')"
            wf-if="!state.main.showFilterInput &amp;&amp; state.main.options.filter.length"
            value=""
          ></button>
          <div
            class="relative min-w-20 flex-1"
            wf-if="state.main.tmp.showFilterInput || !state.main.options.filter.length"
          >
            <input
              type="text"
              placeholder="add filter"
              class="border px-2 py-0.5 outline-none w-32 text-sm rounded-full text-center w-full"
              value=""
              id="taginput"
              wf-onkeyup="post('main.filterKeyUp', event)"
              wf-onblur="post('main.toggleFilterInput')"
              wf-onattach="_1.select()"
            />
            <div
              class="border p-2 rounded bg-white shadow max-h-48 overflow-auto absolute left-1 right-1 flex flex-col text-sm gap-1 top-[110%]"
              wf-if="document.querySelector('#taginput').value.trim() || state.main.tmp.tagSuggestions?.length"
              hidden=""
            >
              <button
                class="underline text-blue-600"
                wf-map="x of state.main.tmp.tagSuggestions?.slice?.()?.sort?.()"
                wf-onclick="post('main.filter', x)"
                value=""
              >
                {{x}}
              </button>
              <div
                class="text-center"
                wf-if="!state.main.tmp.tagSuggestions?.length"
              >
                no such tag found
              </div>
            </div>
          </div>
        </div>
        <div class="mt-2 flex-1" wf-if="state.main.tmp.panel === 'settings'">
          <div>
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-1.5">
                <div>üôçüèª‚Äç‚ôÇÔ∏è</div>
                <span class="text-gray-700 text-sm">Display Name</span>
              </div>
              <input
                value=""
                class="w-36 bg-white rounded border border-slate-200 px-3 outline-none focus:border-slate-400"
                placeholder="Your name"
                wf-value="state.main.options.displayName"
                wf-onkeyup="post('main.persist')"
              />
            </div>
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-1.5">
                <div>üîë</div>
                <span class="text-gray-700 text-sm">OpenAI Key</span>
              </div>
              <input
                value=""
                class="w-36 bg-white rounded border border-slate-200 px-3 outline-none focus:border-slate-400"
                type="password"
                placeholder="sk-shhh..."
                wf-value="state.main.options.oaiKey"
                wf-onkeyup="post('main.persist')"
              />
            </div>
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-1.5">
                <div>üîë</div>
                <span class="text-gray-700 text-sm">xAI Key</span>
              </div>
              <input
                value=""
                class="w-36 bg-white rounded border border-slate-200 px-3 outline-none focus:border-slate-400"
                type="password"
                placeholder="xai-shhh..."
                wf-value="state.main.options.xaiKey"
                wf-onkeyup="post('main.persist')"
              />
            </div>
            <div wf-if="state.main.options.oaiKey || state.main.options.xaiKey">
              <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-1.5">
                  <div>üè∑Ô∏è</div>
                  <span class="text-gray-700 text-sm"> Automatic Tagging </span>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    class="peer hidden"
                    wf-checked="state.main.options.autotag"
                    wf-onchange="post('main.toggleAutoTagging', event)"
                    value="on"
                  />
                  <div
                    class="w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500"
                  ></div>
                  <div
                    class="absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5"
                  ></div>
                </label>
              </div>
              <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-1.5">
                  <div>1Ô∏è‚É£</div>
                  <span class="text-gray-700 text-sm">Unary Messaging</span>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    class="peer hidden"
                    wf-checked="state.main.options.unary"
                    wf-onchange="post('main.toggleUnaryMessaging', event)"
                    value="on"
                  />
                  <div
                    class="w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500"
                  ></div>
                  <div
                    class="absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5"
                  ></div>
                </label>
              </div>
              <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-1.5">
                  <div>üòè</div>
                  <span class="text-gray-700 text-sm"> Show Erotica </span>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    class="peer hidden"
                    wf-checked="state.main.options.showErotica"
                    wf-onchange="post('main.toggleShowErotica', event)"
                    value="on"
                  />
                  <div
                    class="w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500"
                  ></div>
                  <div
                    class="absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5"
                  ></div>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div
          class="flex-1 flex flex-col justify-center items-center gap-4"
          wf-if="state.main.tmp.panel === 'threads' &amp;&amp; !state.main.displayedThreads.length &amp;&amp; !state.main.thread"
        >
          <div class="nf nf-fa-star text-6xl text-gray-300"></div>
          <div class="text-gray-400">Start a new thread!</div>
        </div>
        <div
          class="flex-1 flex flex-col justify-center items-center gap-4"
          wf-if="state.main.tmp.panel === 'archives' &amp;&amp; !state.main.displayedThreads.length"
        >
          <div class="nf text-6xl text-gray-300 nf-md-delete_empty"></div>
          <div class="text-gray-400">Archives are empty.</div>
        </div>

        <div
          class="flex-1 flex flex-col gap-1.5 min-h-0 overflow-auto min-h-min shrink-0"
          wf-map="room of state.main.options.rooms?.filter?.(x =&gt; x.active &amp;&amp; state.main.tmp.roomThreads?.[x.id]?.length)"
        >
          <div
            class="uppercase text-sm tracking-widest text-gray-400 text-right"
          >
            {{room.name}}
          </div>
          <div
            class=""
            wf-map="thread of state.main.tmp.roomThreads?.[room.id] || []"
          >
            <button
              class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 flex items-center justify-between group text-sm hover:bg-gray-900 hover:text-white outline-none w-full lightweight"
              wf-onclick="post('main.openThread', thread)"
              value=""
            >
              <div class="flex items-center gap-1.5">
                <div
                  class="nf nf-fa-chevron_right relative top-px"
                  wf-if="state.main.thread === thread"
                ></div>
                <div class="text-left">{{thread.name || '...'}}</div>
                <div
                  class="text-base nf nf-md-fire text-gray-400 group-hover:text-gray-300"
                  wf-if="thread.tags?.includes?.('erotica')"
                ></div>
              </div>
            </button>
          </div>
        </div>
        <div
          class="flex-1 flex flex-col gap-1.5 min-h-0 overflow-auto min-h-min shrink-0"
          wf-if="state.main.displayedThreads.length"
        >
          <div
            class="uppercase text-sm tracking-widest text-gray-400 text-right"
            wf-if="state.main.options.rooms?.some?.(x =&gt; x.active)"
          >
            My Threads
          </div>
          <div class="" wf-map="thread of state.main.displayedThreads">
            <button
              class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 flex items-center justify-between group text-sm hover:bg-gray-900 hover:text-white outline-none w-full lightweight"
              wf-onclick="post('main.openThread', thread)"
              value=""
            >
              <div class="flex items-center gap-1.5">
                <div
                  class="nf nf-fa-chevron_right relative top-px"
                  wf-if="state.main.thread === thread"
                ></div>
                <div class="text-left">{{thread.name || '...'}}</div>
                <div
                  class="text-base nf nf-md-fire text-gray-400 group-hover:text-gray-300"
                  wf-if="thread.tags?.includes?.('erotica')"
                ></div>
              </div>
              <div>
                <div class="flex gap-1.5 items-center">
                  <div
                    class="text-gray-300 justify-center items-center relative top-[1px] hover:text-gray-100 hidden gap-1 group-hover:flex"
                    wf-class="{{replaces hidden text-gray-300: !thread.rooms?.length ? 'hidden text-gray-300' : 'flex text-green-600 hover:text-green-700'}}"
                    wf-if="state.main.options.rooms?.length"
                    wf-onclick="post('main.shareThread', event, thread)"
                  >
                    <div
                      class="truncate max-w-6 text-xs"
                      wf-if="thread.rooms?.length"
                    >
                      {{thread.rooms?.length}}
                    </div>
                    <div class="nf nf-fa-users"></div>
                  </div>
                  <div
                    class="nf nf-fa-archive hidden group-hover:block text-gray-300 flex justify-center items-center relative top-[1px] hover:text-gray-100"
                    wf-if="!thread.archived"
                    wf-onclick="post('main.toggleArchived', event, thread)"
                  ></div>
                  <div
                    class="nf hidden group-hover:block text-gray-300 nf-md-replay flex justify-center items-center hover:text-gray-100"
                    wf-if="thread.archived"
                    wf-onclick="post('main.toggleArchived', event, thread)"
                  ></div>
                  <div
                    class="nf hidden group-hover:block text-gray-300 nf-oct-x flex justify-center items-center relative top-[1px] hover:text-gray-100"
                    wf-if="thread.archived"
                    wf-onclick="post('main.rm', event, thread)"
                  ></div>
                </div>
              </div>
            </button>
          </div>
        </div>
        <div
          class="flex-1 flex flex-col gap-1.5 min-h-0 overflow-auto min-h-min shrink-0"
          wf-if="state.main.tmp.panel === 'rooms'"
        >
          <div
            class="flex-1 flex flex-col justify-center items-center gap-4"
            wf-if="!state.main.options.rooms?.length"
          >
            <div class="nf text-6xl text-gray-300 nf-fa-users"></div>
            <div class="text-gray-400">Create or join a new room!</div>
          </div>
          <div
            class="group flex flex-col gap-1"
            wf-map="room of state.main.options.rooms"
          >
            <button
              class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 flex items-center justify-between group text-sm outline-none w-full lightweight group-hover:text-white group-hover:bg-gray-900"
              wf-onclick="post('main.toggleRoom', room)"
              value=""
            >
              <div class="flex items-center gap-1.5">
                <div
                  class="nf nf-fa-chevron_right relative top-px"
                  wf-if="state.main.tmp.tryrooms?.[JSON.stringify([room.id, room.name])]"
                ></div>
                <div class="text-left truncate max-w-56">
                  {{room.name || '...'}}
                  {{state.main.vectors(JSON.stringify([room.id, room.name])).length ? `„Äå${state.main.vectors(JSON.stringify([room.id, room.name])).length}„Äç` : ''}}
                </div>
              </div>
              <div>
                <div class="flex gap-1.5 items-center">
                  <div
                    class="nf hidden group-hover:block text-gray-300 justify-center items-center relative top-[1px] hover:text-gray-100 nf-md-key_link"
                    wf-onclick="post('main.copyRoomId', event, room)"
                  ></div>
                  <div
                    class="nf hidden group-hover:block text-gray-300 nf-oct-x flex justify-center items-center relative top-[1px] hover:text-gray-100"
                    wf-onclick="post('main.rmRoom', event, room)"
                  ></div>
                </div>
              </div>
            </button>
            <div
              wf-map="vec of state.main.vectors(JSON.stringify([room.id, room.name]))"
              class="px-3 py-1 hidden group-hover:flex gap-3 items-center truncate text-sm"
              wf-class="{{`text-${hueify(vec.id)}-500`}}"
            >
              <div class="nf nf-fa-user"></div>
              <div>{{vec.displayName || vec.id}}</div>
            </div>
          </div>
        </div>

        <button
          class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 group text-center hover:text-white hover:bg-gray-900 outline-none"
          wf-if="(state.main.options.oaiKey || state.main.options.xaiKey) &amp;&amp; state.main.tmp.panel === 'rooms'"
          wf-onclick="post('main.newRoom')"
          value=""
        >
          Create Room</button
        ><button
          class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 group text-center hover:text-white hover:bg-gray-900 outline-none"
          wf-onclick="post('main.joinRoom')"
          value=""
          wf-if="(state.main.options.oaiKey || state.main.options.xaiKey) &amp;&amp; state.main.tmp.panel === 'rooms'"
        >
          Join Room</button
        ><button
          class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 group text-center hover:text-white hover:bg-gray-900 outline-none"
          wf-onclick="post('main.newThread')"
          value=""
          wf-if="(state.main.options.oaiKey || state.main.options.xaiKey) &amp;&amp; state.main.tmp.panel === 'threads' &amp;&amp; (!state.main.thread || state.main.thread?.logs?.length)"
        >
          New Thread
        </button>
      </div>
      <div class="flex-1 flex flex-col min-h-min">
        <div
          class="border-l border-gray-300 flex justify-center items-center py-16 flex-col gap-4 flex-1"
          wf-if="!state.main.options.oaiKey &amp;&amp; !state.main.options.xaiKey"
          hidden=""
        >
          <div class="text-6xl">üîë</div>
          <div class="text-gray-400">
            Add at least 1 API key to start chatting.
          </div>
        </div>
        <div
          class="border-l border-gray-300 flex justify-center items-center py-16 flex-col gap-4 flex-1"
          wf-if="(state.main.options.oaiKey || state.main.options.xaiKey) &amp;&amp; !state.main.thread"
          hidden=""
        >
          <div
            class="nf nf-fa-star text-6xl text-gray-300"
            wf-if="!state.main.erotica &amp;&amp; !state.main.director &amp;&amp; !state.main.gameMode &amp;&amp; !state.main.voiceMode"
          ></div>
          <div class="text-gray-400">Create a thread to start chatting!</div>
        </div>

        <div
          class="flex-1 bg-white border-l border-gray-300 flex flex-col relative sm:pl-8 h-screen p-3 sm:p-8 gap-3 sm:gap-8"
          wf-if="(state.main.options.oaiKey || state.main.options.xaiKey) &amp;&amp; state.main.thread"
          wf-class=""
        >
          <div
            class="absolute nf nf-md-menu flex justify-center p-3 sm:hidden rounded-full bottom-5 right-5 bg-gray-100 text-gray-600"
            wf-onclick="post('main.toggleSidebar')"
          ></div>
          <div class="py-4 md:py-0">
            <div class="flex items-center group flex-wrap gap-y-1 gap-x-1.5">
              <div class="text-xl sm:text-3xl">
                {{state.main.thread.name || '...'}}
              </div>
              <div class="flex items-center gap-3">
                <div class="flex gap-1">
                  <div
                    class="text-3xl"
                    wf-if="state.main.thread.tags?.includes?.('erotica')"
                  >
                    ü•µ
                  </div>
                </div>
                <div
                  class="gap-1 hidden group-hover:flex"
                  wf-if="!state.main.tmp.threads?.get?.(state.main.thread)?.busy"
                >
                  <button
                    class="nf text-gray-500 text-xl w-8 h-8 nf-oct-pencil"
                    wf-if="!state.main.tmp.threads?.get?.(state.main.thread)?.suggestingName"
                    wf-onclick="post('main.renameThread')"
                    value=""
                  ></button>
                  <button
                    class="nf text-gray-500 text-xl w-8 h-8 nf-md-replay"
                    wf-onclick="post('main.suggestThreadName')"
                    wf-if="!state.main.tmp.suggestingName"
                    value=""
                  ></button>
                </div>
                <div
                  class="nf text-gray-500 text-xl w-8 h-8 flex justify-center items-center nf-fa-spinner animate-spin"
                  wf-onclick="post('main.suggestThreadName')"
                  wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.suggestingName"
                  hidden=""
                ></div>
                <div
                  class="nf nf-md-chat_processing_outline text-3xl animate-pulse -my-4"
                  wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.busy"
                ></div>
              </div>
            </div>
            <div
              class="flex items-center gap-1.5 group flex-wrap mt-3 max-h-[15vh] shrink-0"
            >
              <div class="text-sm relative -top-[1px]">
                {{state.main.thread.tags?.length || state.main.tmp.showTagInput ? 'Tags:' : 'Tags'}}
              </div>
              <div
                class="text-sm px-2 py-0.5 rounded-full shrink-0 flex items-center gap-2 bg-green-200 text-green-600"
                wf-map="x of state.main.thread.tags?.slice?.()?.sort?.() || []"
              >
                <div class="relative -top-[1px]">{{x}}</div>
                <button
                  class="relative -top-[1px] outline-none"
                  wf-onclick="post('main.rmTag', x)"
                  value=""
                >
                  √ó
                </button>
              </div>
              <button
                class="nf nf-fa-plus text-gray-400 outline-none text-sm px-1 py-0.5"
                wf-if="!state.main.tmp.showTagInput"
                wf-onclick="post('main.toggleTagInput')"
                value=""
              ></button>
              <label
                class="relative min-w-20"
                wf-if="state.main.tmp.showTagInput"
              >
                <input
                  type="text"
                  placeholder="add tag"
                  class="border px-2 py-0.5 outline-none text-sm rounded-full text-center w-full"
                  id="taginput2"
                  wf-onkeyup="post('main.tagKeyUp', event)"
                  wf-onblur="setTimeout(() =&gt; post('main.toggleTagInput'), 200)"
                  value=""
                  autocomplete="off"
                  autofocus=""
                />
                <div
                  class="border p-2 rounded bg-white shadow max-h-48 overflow-auto absolute left-1 right-1 flex flex-col text-sm gap-1 top-[110%] z-10"
                  wf-if="state.main.tmp.tagSuggestions?.length"
                  hidden=""
                >
                  <button
                    class="underline text-blue-600 outline-none"
                    wf-map="x of state.main.tmp.tagSuggestions"
                    wf-onclick="post('main.addTag', x)"
                    value=""
                  >
                    {{x}}
                  </button>
                </div>
              </label>
              <div class="flex items-center gap-1.5">
                <button
                  class="nf text-gray-500 nf-md-replay hidden group-hover:block px-1.5 py-0.5 relative -top-[1px] shrink-0"
                  wf-if="!state.main.tmp.showTagInput &amp;&amp; !state.main.tmp.threads?.get?.(state.main.thread)?.suggestingTags"
                  wf-onclick="post('main.suggestThreadTags')"
                  value=""
                ></button>
                <div
                  class="nf text-gray-500 text-xl flex justify-center items-center nf-fa-spinner animate-spin h-[1em]"
                  wf-onclick="post('main.suggestThreadName')"
                  wf-if="state.main.tmp.threads?.get(state.main.thread)?.suggestingTags"
                  hidden=""
                ></div>
              </div>
            </div>
          </div>
          <div
            class="flex-1 basis-0 min-h-0 overflow-auto flex flex-col gap-8 pb-1 xl:min-h-32 min-h-72"
            id="autoscroll"
          >
            <div
              class="flex-1 flex flex-col justify-center items-center gap-4 pt-6"
              wf-if="!state.main.displayedLogs.length"
            >
              <div
                class="nf nf-fa-star text-6xl text-gray-300"
                wf-if="!state.main.erotica &amp;&amp; !state.main.director &amp;&amp; !state.main.gameMode &amp;&amp; !state.main.voiceMode"
              ></div>
              <div
                class="flex gap-1.5"
                wf-if="state.main.erotica || state.main.director || state.main.gameMode || state.main.voiceMode"
              >
                <div class="text-6xl text-gray-300" wf-if="state.main.erotica">
                  ü•µ
                </div>
              </div>
              <div class="text-gray-400">Start a conversation!</div>
            </div>
            <div
              wf-ondetach="state.main.busy = false"
              class="flex flex-col gap-3 sm:gap-4"
            >
              <div
                class=""
                wf-map="log of state.main.displayedLogs.filter(x =&gt; !x.priming)"
              >
                <div class="flex flex-col gap-3 lightweight sm:gap-4">
                  <div
                    class="rounded-lg border border-[#dfe2e5] bg-white shadow flex justify-between group whitespace-pre-wrap p-4 self-end pb-3.5 gap-1 MsgBox hover:bg-gray-100 xl:max-w-3xl max-w-full relative mt-4 xl:w-screen md:min-w-lg w-full"
                    wf-if="log.role === 'user'"
                    wf-onattach="post('main.scroll', _1, log)"
                  >
                    <div class="flex-1 flex flex-col">
                      <div
                        wf-if="log.author"
                        class="whitespace-normal text-xs mb-2"
                        wf-class="{{`text-${hueify(log.author)}-500`}}"
                      >
                        {{state.main.lastDisplayNames[log.author] || `Anonymous User`}}
                      </div>

                      <div
                        wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing !== log"
                        class="flex flex-col gap-3 overflow-auto"
                        wf-innerhtml="markdown(Array.isArray(log.content) ? log.content[0].text : log.content)"
                      >
                        Log content...
                      </div>

                      <img
                        wf-if="Array.isArray(log.content)"
                        class="flex flex-col gap-1.5 pt-2 border-t mt-2"
                        src="../media/__pikachu_pokemon_drawn_by_rio_rio0v0o__1bd2e607737d747a0aa247ca26ab4ee6.png"
                        hidden=""
                      /><textarea
                        class="bg-transparent outline-none w-full h-48"
                        wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing === log"
                        value=""
                        wf-value="state.main.tmp.threads.get(state.main.thread).editingContent"
                        hidden=""
                        wf-onattach="_1.select()"
                      ></textarea>
                    </div>
                    <div
                      class="*:p-1 flex absolute right-6 px-4 py-1 -top-3.5 rounded-full border bg-gray-900 text-white border-gray-800"
                      wf-class="{{replaces flex: state.main.tmp.threads?.get?.(state.main.thread)?.editing === log || log.gameMode ? 'flex' : 'hidden group-hover:flex'}}"
                    >
                      <button
                        class="nf outline-none p-1 nf-md-gamepad_square"
                        wf-onclick="post('main.toggleGameModeLog', log)"
                        value=""
                        wf-class="{{log.gameMode &amp;&amp; 'text-green-500'}}"
                      ></button
                      ><button
                        class="nf nf-oct-pencil outline-none p-1"
                        wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing !== log &amp;&amp; !Array.isArray(log.content)"
                        wf-onclick="post('main.editLog', log)"
                        value=""
                      ></button
                      ><button
                        class="nf outline-none nf-md-replay"
                        wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing === log"
                        wf-onclick="post('main.replayLog', log)"
                        value=""
                      ></button
                      ><button
                        class="nf outline-none nf-fa-check"
                        wf-onclick="post('main.saveLog', log)"
                        value=""
                        wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing === log"
                      ></button
                      ><button
                        class="nf outline-none nf-oct-x"
                        wf-onclick="post(state.main.tmp.threads?.get?.(state.main.thread)?.editing === log ? 'main.revertLog' : 'main.rmLog', log)"
                        value=""
                      ></button>
                    </div>
                  </div>
                  <div
                    class="rounded-lg border border-[#dfe2e5] bg-white shadow flex justify-between group whitespace-pre-wrap p-4 pb-3.5 gap-1 MsgBox hover:bg-gray-100 relative mt-4 xl:max-w-3xl xl:w-screen self-start md:min-w-lg w-full"
                    wf-if="log.role === 'assistant' &amp;&amp; log.content.trim()"
                    wf-onattach="post('main.scroll', _1, log)"
                  >
                    <div class="flex-1 flex flex-col overflow-auto">
                      <div
                        wf-if="log.model"
                        class="whitespace-normal text-xs mb-2"
                        wf-class="{{`text-${hueify(log.model)}-500`}}"
                      >
                        {{log.model}}
                      </div>
                      <div
                        wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing !== log"
                        class="flex flex-col gap-3"
                        wf-innerhtml="markdown(log.content)"
                      >
                        Log content...
                      </div>

                      <textarea
                        class="bg-transparent outline-none w-full h-48"
                        wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing === log"
                        value=""
                        wf-value="state.main.tmp.threads.get(state.main.thread).editingContent"
                        hidden=""
                        wf-onattach="_1.select()"
                      ></textarea>
                    </div>
                    <div
                      class="flex justify-between flex-col"
                      wf-class="{{state.main.thread.gameMode &amp;&amp; 'w-6'}}"
                    >
                      <div
                        class="*:p-1 flex absolute right-6 px-4 py-1 -top-3.5 rounded-full border bg-gray-900 text-white border-gray-800"
                        wf-class="{{replaces flex: state.main.tmp.threads?.get?.(state.main.thread)?.editing === log || log.gameMode ? 'flex' : 'hidden group-hover:flex'}}"
                      >
                        <button
                          class="nf outline-none p-1 nf-md-gamepad_square"
                          wf-onclick="post('main.toggleGameModeLog', log)"
                          value=""
                          wf-class="{{log.gameMode &amp;&amp; 'text-green-500'}}"
                        ></button
                        ><button
                          class="nf nf-oct-pencil outline-none p-1"
                          wf-onclick="post('main.editLog', log)"
                          value=""
                          wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing !== log &amp;&amp; !Array.isArray(log.content)"
                        ></button
                        ><button
                          class="nf outline-none nf-md-replay"
                          wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing === log"
                          wf-onclick="post('main.replayLog', log)"
                          value=""
                        ></button
                        ><button
                          class="nf outline-none nf-fa-check"
                          wf-onclick="post('main.saveLog', log)"
                          value=""
                          wf-if="state.main.tmp.threads?.get?.(state.main.thread)?.editing === log"
                        ></button
                        ><button
                          class="nf outline-none nf-oct-x"
                          wf-onclick="post(state.main.tmp.threads?.get?.(state.main.thread)?.editing === log ? 'main.revertLog' : 'main.rmLog', log)"
                          value=""
                        ></button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div
            id="inputbox"
            class="rounded-lg border bg-white shadow flex items-center justify-between group text-sm hover:bg-gray-100 relative border-[#dfe2e5]"
          >
            <textarea
              class="flex-1 bg-transparent outline-none resize-none p-4 sm:pr-4 pr-16 max-h-[10rem] h-[3.25rem]"
              placeholder="Type a message"
              wf-onkeyup="rawctrls.main.actions.msgKeyUp(event)"
              value=""
              wf-onkeydown="rawctrls.main.actions.msgKeyDown(event)"
            ></textarea>
            <div
              class="self-stretch flex border-l border-[#dfe2e5] relative items-center group"
              wf-if="state.main.models.length || state.main.tmp.loadingModels"
            >
              <div
                class="absolute bottom-[100%] right-0 pb-2 min-w-64"
                wf-if="state.main.tmp.showModels"
                id="modellist"
                hidden=""
              >
                <div
                  class="border p-2 rounded bg-white shadow max-h-48 overflow-auto left-1 right-1 flex flex-col text-sm gap-1 z-10 border-slate-300"
                >
                  <button
                    class="text-blue-600 outline-none flex justify-between items-center gap-3 text-left"
                    wf-onclick="post('main.changeModel', x.id)"
                    value=""
                    wf-map="x of state.main.models"
                  >
                    <div class="underline">{{x.id.split(':')[1]}}</div>
                    <div
                      class="text-sm truncate max-w-24 decoration-none text-slate-500 shrink-0"
                    >
                      {{new Date(x.created * 1000).toLocaleString('en-US', { month: 'short', year: 'numeric' })}}
                    </div>
                  </button>
                </div>
              </div>
              <button
                class="px-4 h-full text-gray-600 hover:text-gray-900 outline-none truncate md:max-w-64 max-w-30"
                wf-if="!state.main.loadingModels"
                wf-onclick="post('main.toggleShowModels')"
                value=""
              >
                {{state.main.model.split(':')[1]}}
              </button>
              <div
                class="nf text-gray-500 text-xl w-8 h-8 flex justify-center items-center nf-fa-spinner animate-spin mx-4"
                wf-onclick="post('main.suggestThreadName')"
                wf-if="state.main.tmp.loadingModels"
                hidden=""
              ></div>
              <div
                class="nf text-gray-500 text-xl w-8 h-8 justify-center items-center mx-4 nf-weather-refresh hidden group-hover:flex"
                wf-onclick="post('main.listModels')"
                wf-if="!state.main.tmp.loadingModels"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
